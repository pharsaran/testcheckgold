# Real-Time Gold Trading System

ระบบซื้อขายทองคำแบบเรียลไทม์ พร้อมการแสดงผลราคาและการจัดการธุรกรรม

## คุณสมบัติ

- **แสดงราคาทองคำแบบเรียลไทม์** จาก 2 แหล่ง:
  - Gold Spot: th.investing.com/commodities/gold (ดอลลาร์/ออนซ์)
  - สมาคมค้าทองคำ: goldtraders.or.th (บาท - ซื้อ/ขาย)
- **ควบคุมสถานะราคา** (Online/Pause/Stop) สำหรับ 3 ประเภท:
  - Gold Spot
  - Gold 99.99% (ทองคำแท่ง)
  - Gold 96.50% (ทองรูปพรรณ)
- **จัดการธุรกรรม** (Buy/Sell) พร้อมแสดงประวัติ
- **Real-Time Updates** ผ่าน WebSocket (Socket.io) - อัปเดตทุก 10 วินาที

## การติดตั้ง

```bash
# ติดตั้ง dependencies
npm install

# รันเซิร์ฟเวอร์
npm start


**หมายเหตุ**: ต้องมี Node.js เวอร์ชัน 20.13.1 หรือสูงกว่า


## การใช้งาน

1. เปิดเบราว์เซอร์ไปที่ `http://localhost:3000`
2. ระบบจะแสดงราคาทองคำแบบเรียลไทม์
3. กดปุ่ม "เปิดการควบคุมสถานะ" เพื่อเปลี่ยนสถานะราคา
4. กดปุ่ม "ซื้อ" หรือ "ขาย" เพื่อทำธุรกรรม

## API Endpoints

### Prices
- `GET /api/prices` - ดึงราคาทองคำทั้งหมด
  - Response: `{ spot: {buy, sell}, gold9999: {buy, sell}, gold9650: {buy, sell} }`

### Status
- `GET /api/status` - ดึงสถานะทั้งหมด
  - Response: `{ spot: 'online'|'pause'|'stop', gold9999: '...', gold9650: '...' }`
- `POST /api/status` - อัปเดตสถานะ
  - Request Body: `{ states: [{ priceType: 'spot', status: 'online' }, ...] }`
  - Response: `{ success: true, statuses: {...} }`
  - **หมายเหตุ**: เมื่อตั้งสถานะเป็น Stop ราคาจะเป็น 0 ทันที

### Transactions
- `GET /api/transactions` - ดึงธุรกรรมทั้งหมด
  - Response: `[{ id, symbol, price, state, dateTime }, ...]`
- `POST /api/transactions` - สร้างธุรกรรมใหม่
  - Request Body: `{ symbol: 'GOLD9999', price: 37500, state: 'buy'|'sell' }`
  - Response: `{ success: true, transaction: {...} }`

## WebSocket Events

### Client → Server
- ไม่มี (Client รับข้อมูลจาก Server เท่านั้น)

### Server → Client
- `initialData` - ส่งข้อมูลเริ่มต้นเมื่อเชื่อมต่อ
  - Data: `{ prices: {...}, statuses: {...}, transactions: [...] }`
- `priceUpdate` - อัปเดตราคาใหม่ (ทุก 10 วินาที)
  - Data: `{ spot: {buy, sell}, gold9999: {buy, sell}, gold9650: {buy, sell} }`
- `statusUpdate` - อัปเดตสถานะเมื่อมีการเปลี่ยนแปลง
  - Data: `{ spot: 'online'|'pause'|'stop', gold9999: '...', gold9650: '...' }`
- `newTransaction` - แจ้งเตือนเมื่อมีธุรกรรมใหม่
  - Data: `{ id, symbol, price, state, dateTime }`

## Test Cases

ดูรายละเอียดการทดสอบทั้งหมดใน [รายละเอียดการเทส.md](./รายละเอียดการเทส.md)


## เทคโนโลยีที่ใช้

### Backend
- **Node.js** - Runtime environment
- **Express.js** - Web framework
- **Socket.io** - WebSocket library สำหรับ real-time communication
- **Puppeteer** - Headless Chrome สำหรับ web scraping
- **Cheerio** - Server-side HTML parsing
- **Axios** - HTTP client

### Frontend
- **HTML5/CSS3** - Structure และ styling
- **JavaScript (Vanilla)** - Client-side logic
- **Socket.io Client** - WebSocket client
- **SweetAlert2** - Alert notifications

### Testing
- **Axios** - HTTP testing
- **Socket.io Client** - WebSocket testing
- **Puppeteer** - Browser automation testing

## สถานะราคา (Price Status)

### Online
- ระบบจะอัปเดตราคาอัตโนมัติทุก 10 วินาที
- ดึงราคาจริงจากแหล่งข้อมูล

### Pause
- ระบบจะหยุดอัปเดตราคา
- แต่ยังคงราคาเดิมไว้

### Stop
- ระบบจะตั้งราคาเป็น 0 ทันที
- ไม่มีการอัปเดตราคา

## หมายเหตุ

- ราคาอัปเดตทุก 10 วินาที
- รองรับผู้ใช้หลายคนพร้อมกัน
- Transaction เก็บข้อมูลใน memory (ไม่ใช้ database)
- การทดสอบใช้ข้อมูลจริงจากระบบ ไม่ได้ hardcode
- เมื่อตั้งสถานะ Stop ราคาจะเป็น 0 ทันที

